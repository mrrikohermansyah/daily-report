<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Daily Report</title>
    <link rel="manifest" href="manifest.json" />
    <link rel="icon" type="image/png" href="logo.png" />
    <link rel="stylesheet" href="style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/exceljs/dist/exceljs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>
  </head>

  <body>
    <!-- Header / Navbar (Sticky & Full Width) -->
    <div class="header-container">
      <div class="container">
        <div class="topbar">
          <div
            class="brand"
            style="flex-direction: column; align-items: flex-start; gap: 0"
          >
            <h1>Daily Report</h1>
            <div id="version_container" style="margin-top: -5px"></div>
          </div>
          <div class="user-actions" id="userActions">
            <div class="user-menu-items" id="userMenuItems">
              <div class="user-status" id="auth_status"></div>
              <button type="button" class="btn-secondary" id="btn_logout">
                Logout
              </button>
            </div>
            <button class="theme-toggle" id="themeToggle" title="Switch Theme">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <circle cx="12" cy="12" r="5"></circle>
                <line x1="12" y1="1" x2="12" y2="3"></line>
                <line x1="12" y1="21" x2="12" y2="23"></line>
                <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                <line x1="1" y1="12" x2="3" y2="12"></line>
                <line x1="21" y1="12" x2="23" y2="12"></line>
                <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
              </svg>
            </button>
            <button
              class="mobile-menu-btn"
              id="mobileMenuBtn"
              aria-label="Menu"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <line x1="3" y1="12" x2="21" y2="12"></line>
                <line x1="3" y1="6" x2="21" y2="6"></line>
                <line x1="3" y1="18" x2="21" y2="18"></line>
              </svg>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Main Content -->
    <div class="main-container">
      <main class="content section-grid">
        <section class="card" id="card_input">
          <h2 class="card-title">Input Report</h2>
          <form id="reportForm" class="form">
            <div class="form-group">
              <label for="inv_code">Inv Code (Sticker On Device)</label>
              <input
                type="text"
                id="inv_code"
                placeholder="PC20024MEB"
                required
              />
            </div>

            <div class="form-group">
              <label>Kode / Code</label>
              <div class="checkbox-group">
                <label class="chip"
                  ><input type="checkbox" value="HW" /><span>HW</span></label
                >
                <label class="chip"
                  ><input type="checkbox" value="SW" /><span>SW</span></label
                >
                <label class="chip"
                  ><input type="checkbox" value="NW" /><span>NW</span></label
                >
                <label class="chip"
                  ><input type="checkbox" value="MV" /><span>MV</span></label
                >
                <label class="chip"
                  ><input type="checkbox" value="OT" /><span>OT</span></label
                >
                <label class="chip"
                  ><input type="checkbox" value="DR" /><span>DR</span></label
                >
              </div>
            </div>

            <div class="form-group">
              <label for="lokasi">Location</label>
              <select id="lokasi" required>
                <option value="Blue Office">Blue Office</option>
                <option value="Clinic">Clinic</option>
                <option value="Control Room">Control Room</option>
                <option value="Dark Room">Dark Room</option>
                <option value="Green Office">Green Office</option>
                <option value="HRD">HR Department</option>
                <option value="HSE Yard">HSE Yard</option>
                <option value="IT Server">IT Server</option>
                <option value="IT Store">IT Store</option>
                <option value="Multi Purposes Building">
                  Multi Purposes Building
                </option>
                <option value="Red Office">Red Office</option>
                <option value="Security">Security</option>
                <option value="Store 1">Store 1</option>
                <option value="Store 2">Store 2</option>
                <option value="Store 3">Store 3</option>
                <option value="Store 4">Store 4</option>
                <option value="Store 5">Store 5</option>
                <option value="Store 6">Store 6</option>
                <option value="Warehouse">Warehouse</option>
                <option value="White Office">White Office</option>
                <option value="White Office 2nd Fl">
                  White Office 2nd Floor
                </option>
                <option value="White Office 3rd Fl">
                  White Office 3rd Floor
                </option>
                <option value="Welding School">Welding School</option>
                <option value="Workshop9">Workshop 9</option>
                <option value="Workshop10">Workshop 10</option>
                <option value="Workshop11">Workshop 11</option>
                <option value="Workshop12">Workshop 12</option>
                <option value="Yard">Yard</option>
                <option value="Rest Area">Rest Area</option>
                <option value="Lainlain">Other Location</option>
              </select>
            </div>

            <div class="form-group">
              <label for="remarks">Keterangan / Remarks</label>
              <textarea id="remarks" required></textarea>
            </div>

            <div class="form-group">
              <label for="pengguna">Pengguna / User</label>
              <input
                type="text"
                id="pengguna"
                placeholder="User's Name"
                required
              />
            </div>

            <div class="form-row"></div>

            <div class="actions">
              <button type="submit" class="btn-primary">SAVE</button>
            </div>
          </form>
        </section>

        <section class="card" id="card_active">
          <h2 class="card-title">Active Activity(s)</h2>
          <div id="drafts_status" class="muted"></div>
          <div id="activities"></div>
        </section>

        <section class="card">
          <h2 class="card-title">Activities Done (Today)</h2>
          <div class="form-row">
            <div class="form-group">
              <label for="historyDate">Date</label>
              <input type="date" id="historyDate" />
            </div>
          </div>
          <div id="history_activities"></div>
          <div class="actions" style="justify-content: center">
            <button
              type="button"
              class="btn-secondary btn-block"
              id="btn_history_more"
            >
              LOAD MORE
            </button>
          </div>
        </section>

        <section class="card">
          <h2 class="card-title">Export Excel</h2>
          <div class="form-row">
            <div class="form-group">
              <label for="exportTanggal">Date</label>
              <input type="date" id="exportTanggal" />
            </div>
            <div class="form-group">
              <label>&nbsp;</label>
              <button
                class="btn-secondary"
                id="btn_export_excel"
                onclick="exportExcel()"
              >
                EXPORT EXCEL
              </button>
            </div>
          </div>
        </section>

        <footer id="app_footer" class="app-footer"></footer>
      </main>
    </div>

    <script src="app.js"></script>
    <script>
      (function () {
        try {
          fetch("version.html")
            .then((r) => r.text())
            .then((html) => {
              const versionContainer =
                document.getElementById("version_container");
              if (versionContainer) versionContainer.innerHTML = html;
            })
            .catch(() => {});
        } catch {}
      })();
    </script>
    <script>
      if ("serviceWorker" in navigator) {
        window.addEventListener("load", () => {
          navigator.serviceWorker
            .register("./sw.js")
            .then((registration) => {
              console.log(
                "ServiceWorker registration successful with scope: ",
                registration.scope
              );
            })
            .catch((err) => {
              console.log("ServiceWorker registration failed: ", err);
            });
        });
      }
    </script>
  </body>
</html>
